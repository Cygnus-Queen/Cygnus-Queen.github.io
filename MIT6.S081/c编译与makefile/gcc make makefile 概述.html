<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="MIT6.S081的实验都是基于C语言完成的，每当完成一个新函数（例如Lab1的sleep函数），都需要将它加入到makefile文件中编辑，那么弄清楚makefile，gcc相关的一些编译知识就非常有必要了。 GCC概述gcc是一个编译器，将一个c语言代码编译为可执行文件的流程如下：![[Pasted image 20230714160858.png]] 1. 预处理（pre-processin">
<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/MIT6.S081/c%E7%BC%96%E8%AF%91%E4%B8%8Emakefile/gcc%20make%20makefile%20%E6%A6%82%E8%BF%B0.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="MIT6.S081的实验都是基于C语言完成的，每当完成一个新函数（例如Lab1的sleep函数），都需要将它加入到makefile文件中编辑，那么弄清楚makefile，gcc相关的一些编译知识就非常有必要了。 GCC概述gcc是一个编译器，将一个c语言代码编译为可执行文件的流程如下：![[Pasted image 20230714160858.png]] 1. 预处理（pre-processin">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-08-14T09:04:08.540Z">
<meta property="article:modified_time" content="2023-08-14T09:04:08.540Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="page-" class="h-entry article article-type-page" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/MIT6.S081/c%E7%BC%96%E8%AF%91%E4%B8%8Emakefile/gcc%20make%20makefile%20%E6%A6%82%E8%BF%B0.html" class="article-date">
  <time class="dt-published" datetime="2023-08-14T09:04:08.540Z" itemprop="datePublished">2023-08-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>MIT6.S081的实验都是基于C语言完成的，每当完成一个新函数（例如Lab1的sleep函数），都需要将它加入到makefile文件中编辑，那么弄清楚makefile，gcc相关的一些编译知识就非常有必要了。</p>
<h2 id="GCC概述"><a href="#GCC概述" class="headerlink" title="GCC概述"></a>GCC概述</h2><p>gcc是一个编译器，将一个c语言代码编译为可执行文件的流程如下：<br>![[Pasted image 20230714160858.png]]</p>
<p><strong>1. 预处理（pre-processing）</strong><br><code>gcc -E hello.c -o hello.i</code>，将引入的头文件（#include）和定义的宏（#define）扩展到代码中，预处理之后的程序还是文本，可以用文本编辑器打开，上述命令中-E是让编译器在预处理之后就退出，不进行后续编译过程</p>
<p><strong>2. 编译（compilation）</strong><br><code>gcc -S hello.i -o hello.s</code>，将预处理过的文件编译成汇编程序，在编译时，编译器只检测程序语法，和函数、变量是否被声明。如果函数未被声明，编译器会给出一个警告，但可以生成Object File。而在链接程序时，链接器会在所有的Object File中找寻函数的实现，如果找不到，那到就会报链接错误码（Linker Error）</p>
<p><strong>3. 汇编（assembly）</strong><br><code>gcc -c hello.s hello.o</code>，将汇编程序转换成目标文件，二进制格式机器码，每一个源文件都需要产生一个目标文件</p>
<p><strong>4. 链接（linker）</strong><br><code>gcc hello.o -o hello</code>，将一个或多个目标文件连接成最终的可执行文件</p>
<h2 id="GCC常用参数"><a href="#GCC常用参数" class="headerlink" title="GCC常用参数"></a>GCC常用参数</h2><ol>
<li>–version 查看版本</li>
<li>-v（verbose冗长的），输出编译的详细信息 </li>
<li>-std 指定标准</li>
<li>-o 指定输出文件的名称</li>
<li>-Wall 输出所有的警告信息</li>
<li>-c 只将源文件编译为 object 文件（*.o），而不进行链接，之后可以使用 <code>gcc -o myprog.exe file1.o file2.o</code> 将多个 object 文件连接成可执行文件</li>
<li>-shared 编译为共享库（*.dll，*.so）</li>
<li>-S 编译为汇编代码</li>
</ol>
<h2 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h2><p><strong>会不会写makefile，从一个侧面说明了一个人是否具备完成大型工程的能力</strong>。因为，makefile关系到了整个工程的编译规则。一个工程中的源文件不计数，其按<strong>类型、功能、模块</strong>分别放在若干个目录中，makefile定义了一系列的规则来指定，哪些文件需要先编译，哪些文件需要后编译，哪些文件需要重新编译，甚至于进行更复杂的功能操作</p>
<p>因为makefile就像一个Shell脚本一样，其中也可以执行操作系统的命令。makefile带来的好处就是“自动化编译”，一旦写好，只需要一个make命令，整个工程完全自动编译，极大的提高了软件开发的效率。make是一个命令工具，是一个解释makefile中指令的命令工具，一般来说，大多数的IDE都有这个命令，比如：Delphi的make，Visual C++的nmake，Linux下GNU的make。可见，makefile成为了一种在工程方面的编译方法。</p>
<p>但是不同的厂商make各不相同，本介绍只对GNU的make进行介绍。</p>
<h4 id="Makefile里有什么？"><a href="#Makefile里有什么？" class="headerlink" title="Makefile里有什么？"></a>Makefile里有什么？</h4><p>Makefile里主要包含了<strong>五个东西：显式规则、隐晦规则、变量定义、文件指示和注释。</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/MIT6.S081/c%E7%BC%96%E8%AF%91%E4%B8%8Emakefile/gcc%20make%20makefile%20%E6%A6%82%E8%BF%B0.html" data-id="clomm1veq0005acvy1pog014f" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/11/06/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>