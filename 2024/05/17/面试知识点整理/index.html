

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Cygnus">
  <meta name="keywords" content="">
  
    <meta name="description" content="自我介绍：面试官您好 ，我叫蒋健君，是一名来自电子科技大学的全日制硕士。我拥有一段项目经历和一段实习经验。在项目中，我注重打基础，通过优化和实现多个功能，学习了操作系统内核的文件系统、中断处理、进程调度、内存分配等模块。在实习中，我接触到了实际的程序化广告生产环境，负责了回调信息收集上报模块中某一个路由的实现。由于我本科的大数据专业背景以及硕士接触了AIGC相关内容，因此有较广的知识面，在和产品对">
<meta property="og:type" content="article">
<meta property="og:title" content="面试知识点整理">
<meta property="og:url" content="http://example.com/2024/05/17/%E9%9D%A2%E8%AF%95%E7%9F%A5%E8%AF%86%E7%82%B9%E6%95%B4%E7%90%86/index.html">
<meta property="og:site_name" content="Cygnus的博客">
<meta property="og:description" content="自我介绍：面试官您好 ，我叫蒋健君，是一名来自电子科技大学的全日制硕士。我拥有一段项目经历和一段实习经验。在项目中，我注重打基础，通过优化和实现多个功能，学习了操作系统内核的文件系统、中断处理、进程调度、内存分配等模块。在实习中，我接触到了实际的程序化广告生产环境，负责了回调信息收集上报模块中某一个路由的实现。由于我本科的大数据专业背景以及硕士接触了AIGC相关内容，因此有较广的知识面，在和产品对">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-05-17T13:22:11.000Z">
<meta property="article:modified_time" content="2024-05-17T13:37:44.042Z">
<meta property="article:author" content="Cygnus">
<meta property="article:tag" content="面经">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>面试知识点整理 - Cygnus的博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Cygnus</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/%E4%BB%99%E5%89%91%E9%97%AE%E6%83%85%E5%A5%B3%E7%A5%9E.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="面试知识点整理"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-05-17 21:22" pubdate>
          2024年5月17日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          9.6k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          80 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">面试知识点整理</h1>
            
            
              <div class="markdown-body">
                
                <p>自我介绍：<br>面试官您好 ，我叫蒋健君，是一名来自电子科技大学的全日制硕士。我拥有一段项目经历和一段实习经验。在项目中，我注重打基础，通过优化和实现多个功能，学习了操作系统内核的文件系统、中断处理、进程调度、内存分配等模块。在实习中，我接触到了实际的程序化广告生产环境，负责了回调信息收集上报模块中某一个路由的实现。由于我本科的大数据专业背景以及硕士接触了AIGC相关内容，因此有较广的知识面，在和产品对接时会具备一定的优势。以上就是我的个人情况，贵公司对我有很大的吸引力，希望贵公司能够给我这个工作机会，我有信心，也有决心做好这份工作。</p>
<h2 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h2><h4 id="零拷贝技术"><a href="#零拷贝技术" class="headerlink" title="零拷贝技术"></a>零拷贝技术</h4><p>（1）讲一讲零拷贝技术？<br>零拷贝技术是一种用来<strong>提高文件传输的性能</strong>的技术。它主要解决两个方面的问题：<br>第一是使用DMA和SG-DMA替代CPU来进行数据搬运。传统的文件传输是磁盘准备好数据后发送一个电信号到中断控制寄存器的引脚引发中断，CPU通过中断处理处理函数中一个字节一个字节的完成数据搬运，效率很低。而DMA技术则是帮助CPU进行磁盘数据搬运，完成后再向CPU发出通知。如果网卡支持SG-DMA，则从内核缓冲区到socket缓冲区的拷贝也可以不使用CPU。<br>第二是尽量减少数据在内核和用户空间之间的拷贝次数。由于内核空间和用户空间的隔离，用户想要发起一次网络请求，需要先通过read系统调用将数据从内核态拷贝到用户态的数组中，然后再通过write系统调用拷贝回内核态，封装为sk_buff执行网络模型的逻辑然后发送出去。这个过程涉及到了四次特权等级切换和两次数据拷贝，性能低下。因为文件传输的场景中，在用户态我们不需要对数据再加工，所以可以通过引入mmap建立用户空间和物理空间的映射关系，与内核共享一个缓冲区，减少一次从内核态到用户态的数据拷贝。</p>
<h4 id="IO多路复用"><a href="#IO多路复用" class="headerlink" title="IO多路复用"></a>IO多路复用</h4><p>（1）select/poll/epoll<br>这三种都是用来解决C10K问题的IO多路复用模型。<br>select将已连接的 Socket 都放到一个<strong>文件描述符集合</strong>中copy进内核，内核遍历这个大小有限的集合检查到就绪的Socket，就把整个集合拷贝回用户态，用户态遍历找到就绪的Socket进行处理。<br>poll 用动态数组取代 BitsMap，避免了文件描述符的个数限制<br>epoll的核心是红黑树+事件驱动机制。使用红黑树来维护文件描述符，使用链表记录就绪事件，当红黑树中的某个 socket 有事件发生时，通过<strong>回调函数</strong>内核会将其加入到就绪事件链表中。用户调用 <code>epoll_wait()</code> 函数时，内核会将就绪的事件copy到用户空间让用户处理。</p>
<p>（2）具体说说epoll？<br>epoll是一个在linux上的IO多路复用模型，是用来解决C10K问题的利器。很多知名的组件例如redis、nginx，包括Go的net库都对它进行了封装。<br>epoll的核心是红黑树+事件驱动机制。使用红黑树来维护文件描述符，使用链表记录就绪事件，当红黑树中的某个 socket 有事件发生时，通过<strong>回调函数</strong>内核会将其加入到就绪事件链表中，用户调用epoll_wait()可以将就绪链表copy到用户态进行处理<br>epoll模型涉及到epoll_create，epoll_ctl，epoll_wait，epoll_event_callback四个核心函数和epitem，eventpoll两个核心数据结构。create函数创建一个eventpoll结构，并初始化。eventpoll包含了一个红黑树指针rbr和一个链表指针rdlist，这两个结构体内部的节点数据类型均为epitem，封装一个文件描述符的同时还添加了用户感兴趣的事件epoll_event。当用户调用epoll_ctl就创建一个epitem插入到红黑树中。当事件发生，例如客户端调用connect连入，内核根据对应的事件在红黑树中找到对应的epitem并加入到就绪链表。用户调用epoll_wait时，内核将就绪链表中的节点摘取下来，copy到用户态空间，用户开始执行业务逻辑。</p>
<h4 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h4><p>（1）如何理解一致性hash？<br>在高并发场景下，需要集群对外提供服务，这就涉及到负载均衡问题。一致性hash是一种用来解决负载均衡问题的算法。传统的hash算法不能适应当下环境的三高要求（高并发，高可扩、高性能），当机器的数量发生变化时，会导致映射关系改变，出现缓存失效和数据迁移问题。<br>一致性hash算法被提出用来解决这个问题。它通过将整个hash空间映射成一个环，将机器id映射在环上，将环分割成了多个区域。当请求来临时根据映射的区域来选择对应的机器。这样当存在扩容缩容时，数据迁移和缓存失效不会影响到集群的所有的机器。<br>该算法还可以继续优化，通过构造两层映射关系，<strong>不再将虚拟节点替代真实节点映射到哈希环上，再将虚拟节点映射到实际节点</strong>，可以避免机器负载不均匀的问题。</p>
<h4 id="中断"><a href="#中断" class="headerlink" title="中断"></a>中断</h4><p>（1）讲一讲中断发生的过程？<br>和下面差不多。</p>
<p>（2）讲一讲系统调用发生的过程？<br>系统调用是操作系统暴露给用户操作系统资源的接口。用户使用系统调用和使用其他函数的方式是一样的，有对应的声明和实现，但是它的实现并不是业务实现，而是包含在一个系统在编译时生成的.S汇编文件中，汇编代码将系统调用的名称统一为sys开头的字符串，并放入寄存器，随后调用ecall指令调整CPU特权等级，进入内核态，同时保存PC寄存器的值到spec寄存器，再将stvec寄存器的值加载到PC中，该寄存器中保存的是中断处理函数uservec的入口，该函数会从sscratch寄存器取出保存进程上下文的trapframe结构体指针，并保护现场，并取出trapframe结构体中内核栈指针，内核页表指针保存到对应的寄存器。随后的操作就是在内核中进行了。<br>中断处理函数根据scause寄存器中的值来判断发生中断的类型，该寄存器的值是可以通过不同的中断场景利用电信号操作寄存器引脚进行修改。利用if else语句根据不同的值，采取不同的处理逻辑。由于是系统调用，会跳转到系统调用专用的函数，正式开始系统调用的业务逻辑。<br>通过从寄存器中取出对应的系统调用名称，映射为系统调用号，再利用系统调用号映射到对应的系统调用函数，系统调用函数再通过寄存器取出需要的参数，执行具体的业务逻辑，随后调用中断处理函数返回到用户态。也就是将刚刚的动作反过来执行一遍，设置各种寄存器的值，最后通过ret将之前保存再sepc寄存器中的值重置回PC，完成跳转</p>
<h4 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h4><p>（1）讲一讲操作系统中的锁</p>
<h3 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h3><h3 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h3><p>（1）页面自动刷新是如何实现的？<br>利用websocket协议，服务器可以主动向客户端推送信息，如果页面有新数据就可以主动推送给客户端，客户端页面完成刷新，它适用于<strong>需要服务器和客户端（浏览器）频繁交互</strong>的大部分场景，比如网页/小程序游戏，网页聊天室，以及一些类似飞书这样的网页协同办公软件</p>
<p>一般来说浏览器在 <strong>TCP 三次握手</strong>建立连接之后，都<strong>统一使用 HTTP 协议</strong>先进行一次通信，如果此时是<strong>普通的 HTTP 请求</strong>，那后续双方就还是老样子继续用普通 HTTP 协议进行交互，<strong>想建立 WebSocket 连接</strong>，就会在 HTTP 请求里带上一些<strong>特殊的header 头</strong>表示想升级成websocket协议。http101状态码表示协议切换</p>
<p>（2）http如何设置长连接<br>在客户端和服务端的header添加添加connect：<strong>Keep-Alive</strong>，当一次http请求完成后不会关闭TCP链接。长连接可以避免不必要的TCP握手和挥手过程，提高性能，带来<strong>更好的用户体验</strong></p>
<p>（3）状态码<br>    <a target="_blank" rel="noopener" href="https://xiaolincoding.com/network/2_http/http_interview.html#http-%E5%B8%B8%E8%A7%81%E7%9A%84%E7%8A%B6%E6%80%81%E7%A0%81%E6%9C%89%E5%93%AA%E4%BA%9B">3.1 HTTP 常见面试题 | 小林coding (xiaolincoding.com)</a></p>
<p>（4）Get和post的区别？<br><strong>GET 的语义是从服务器获取指定的资源</strong>，安全（不会破坏服务器资源）幂等（多次执行结果相同）<br><strong>POST 的语义是根据请求负荷（报文body）对指定的资源做出处理</strong>，不安全不幂等</p>
<p>（5）http1.1的特点？<br>无状态，有关联性的操作时会非常麻烦，引入cookie解决<br><strong>明文传输</strong>，不安全，添加TLS变为https<br><strong>长连接</strong>，减少了 TCP 连接的重复建立和断开所造成的额外开销<br><strong>队头阻塞</strong>，顺序发送的请求序列中的请求被阻塞时，在后面排队的所有请求也一同被阻塞</p>
<p>头部冗余，请求 / 响应头部（Header）未经压缩就发送，只能压缩 Body的部分<br>不存在客户端主动推送</p>
<p>（6）https的特点？<br>HTTP<strong>S</strong> 在 HTTP 与 TCP 层之间加入了 <code>SSL/TLS</code> 协议，解决窃听风险（<strong>混合加密</strong>）、篡改风险（<strong>摘要算法</strong>）、冒充风险（<strong>数字证书</strong>）。</p>
<p>（7）TLS四次握手？<br>第一次握手：<br>    客户端指定TLS版本，支持的密码套件、随机数a<br>第二次握手：<br>    服务端确认TLS版本，密码类型（rsa）、随机数b<br>    数字证书<br>第三握手：<br>    生成随机数c，利用abc三个随机数生成对称密钥<br>    客户端校验数字证书，取出公钥加密对称密钥并发送出去<br>    通知改用对称密钥（对称密钥加密）<br>    发送握手数据的摘要（对称密钥加密）<br>第四握手：<br>    通知改用对称密钥（对称密钥加密）<br>    发送握手数据的摘要（对称密钥加密）</p>
<p>（8）数字证书如何签发和校验？<br>CA计算持有者的公钥、用途、颁发者、有效时间等信息的hash值，用私钥加密形成证书<br>客户端会使用同样的 Hash 算法获取证书的 Hash 值，用公钥解密比对判断是否正确</p>
<p>（9）证书信任链的问题？<br>客户端收到证书后，发现这个证书的签发者不是根证书，于是向上申请一直到根证书，利用根证书中的公钥去验证当前证书的签发者的证书，如果可信，就能用它的公钥再去验证当前证书</p>
<p>（10）http2.0？<br>头部压缩：将头部信息和body信息压缩为二进制帧<br>    静态表，高频key进行哈夫曼编码传输<br>    动态表，不在静态表中的字段先用哈夫曼编码传输，然后在静态表后面添加该key，下次就不需要传输字段了，传输编码即可<br>二进制传输：<br>    无需再将明文的报文转成二进制，而是直接解析二进制报文，增加了数据传输的效率<br>并发传输（解决队头阻塞）<br>    引出了 Stream 概念，多个 Stream 复用在一条 TCP 连接，<strong>针对不同的 HTTP 请求用独一无二的 Stream ID 来区分</strong>，<strong>接收端可以通过 Stream ID 有序组装成 HTTP 消息，不同 Stream 的帧是可以乱序发送的</strong><br>服务器主动推送：<br>    客户端和服务器<strong>双方都可以建立 Stream</strong>， Stream ID 也是有区别的，客户端建立的 Stream 必须是奇数号，而服务器建立的 Stream 必须是偶数号</p>
<p>缺陷：基于 TCP 协议，存在传输层层面的队头阻塞</p>
<p>（11）http3.0？<br>把 HTTP 下层的 TCP 协议改成了 UDP，基于UDP实现QUIC。<br>无队头阻塞：<br>    <strong>当某个流丢包时只会阻塞这个流，其他流不会受到影响，因此不存在队头阻塞问题</strong><br>更快的连接建立：<br>    TCP 和 TLS 是分层的，分别属于内核传输层和用户态应用层，QUIC 内部包含了 TLS，在QUIC三次握手中完成TLS握手<br>连接迁移：<br>    TCP连接当IP发送变化，导致四元组发生变化，原本的连接失效，要重新建立连接，带来卡顿<br>    QUIC 协议没有用四元组的方式来“绑定”连接，而是使用连接ID来标记通信的两个端点，即使移动设备的网络变化后，导致 IP 地址变化了，但只要ID没变，则复用连接，不需要重新建立连接</p>
<h3 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h3><p>（1）什么是 TCP 延迟确认机制？</p>
<ul>
<li>当有响应数据要发送时，ACK 会随着响应数据一起立刻发送给对方</li>
<li>当没有响应数据要发送时，ACK 将会延迟一段时间，以等待是否有响应数据可以一起发送</li>
<li>如果在延迟等待发送 ACK 期间，对方的第二个数据报文又到达了，这时就会立刻发送 ACK</li>
</ul>
<p>（2）TCP粘包如何处理？<br>交给应用层处理</p>
<p>（3）TCP重传、滑动窗口、拥塞控制</p>
<ul>
<li>超时重传 + 快速重传 + SACK + D-SACK</li>
<li>流量控制是利用接收方的可用窗口大小来控制的，<strong>避免「发送方」的数据填满接收方缓冲区</strong></li>
<li>拥塞窗口是<strong>避免「发送方」的数据填满整个网络</strong>，<strong>发生了超时重传，就会认为网络出现了拥塞。</strong><br>  慢启动：<strong>当发送方每收到一个 ACK，拥塞窗口 cwnd 的大小就会加 1</strong>，有一个阈值<br>  进入拥塞避免算法后，它的规则是：<strong>每当收到一个 ACK 时，cwnd 增加 1/cwnd</strong><br>  当发生了「超时重传」，则就会使用拥塞发生算法，阈值变为当前窗口的1/2，窗口变为1<br>  快恢复：收到 3 个重复 ACK 说明网络也不那么糟糕，阈值恢复，窗口变为原来的一半</li>
</ul>
<h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><p>（1）如何保证数据库和缓存一致性？<br>有两种方案，延迟双删、异步信息+可靠信息删除<br>前者先删缓存，然而更新数据库，过几秒再删除缓存<br>后者是大厂使用的方案，更新数据库后不做操作，由其他组件监听binlog日志，推送到消息队列，redis订阅该topic，执行更新操作，更新失败可以重试。</p>
<h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><h3 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h3><p>（1）数据加密后如何模糊查询？<br>方案一：使用数据库加解密函数先解密再模糊查找，缺点在于无法利用数据库的索引来优化查询<br>方案二：新建一张分词密文映射表，对敏感字段进行分词组合，如“15503770537”的分词组合有“155”、“0377”、“0537”等，再对每个分词进行加密，建立起敏感字段的分词密文与目标数据行主键的关联关系；在处理模糊查询的时候，对模糊查询关键字进行加密，用加密后的模糊查询关键字，对分词密文映射表进行like查询，得到目标数据行的主键，再以目标数据行的主键为条件返回目标表进行精确查询</p>
<h2 id="Go"><a href="#Go" class="headerlink" title="Go"></a>Go</h2><p>（1）为什么要用协程？<br>使用协程是因为相较于多线程，可以节省CPU，避免内核级线程频繁切换，同时节约内存。我看了测试，协程切换的耗时大概是100ns，是线程切换耗时的二十分之一。</p>
<p>（2）golang是值传递还是引用传递？深拷贝还是浅拷贝<br>值传递；浅拷贝，copy是深拷贝</p>
<p>（3）context对象作用 原理</p>
<p>（4）Go的锁机制？<br>sync包提供了Mutex互斥锁和RWMutex读写锁</p>
<h2 id="K8S"><a href="#K8S" class="headerlink" title="K8S"></a>K8S</h2><p>（1）什么是k8s？<br>k8s是一个开源容器编排平台，可以理解为服务与服务器之间的中间价，实现容器化应用的自动部署，管理、扩展、负载均衡。整个架构分为control和node两个部分。<br>control节点的具体组件包括用来操作服务资源的API server，用来保存k8s数据的etcd，决定pod调度的scheduler，执行调度的Contorller manager。Node节点包括容器运行时组件Container runtime,用来接收Controller manager指令的kubelet，负责node网络通信的kube proxy和一系列pod。每个pod除了包括业务容器，还包括了搭配的日志收集器等容器，是k8s调度的基本单位</p>
<p>总之，k8s本质就是服务和服务器之间的中间层，通过暴露一系列API能力，简化服务的部署和运维流程。</p>
<p>（2）如何使用k8s？（如何部署服务？）<br>编写yaml文件，指定镜像和需要的系统资源。然后执行，kubectl apply -f xxx.yaml。kubectl将读取和解析yaml文件，通过http请求发送给API Server，它根据要求驱使Controller manager创建pod，scheduler寻找合适的node并调度pod。某node中的kubelet收到命令后会根据container runner拉取镜像，创建pod的containe，之后会定期检查容器的状态，如果容器失败或被终止，Kubelet 会将容器的状态更新到 Kubernetes API Server 中。</p>
<p>（3）如何访问服务？<br>外部请求先到达k8s集群的ingress，然后被转发到某个node的<br>kube proxy，找到对应pod进行处理。</p>
<p>（4）什么是service？<br>Service 是对一组提供相同功能的 Pods 的抽象，并为它们提供一个统一的入口。借助 Service，应用可以方便的实现服务发现与负载均衡</p>
<p>（5）什么是Deployment?<br>Deployment 为 Pod 和 Replica Set提供声明式更新，只需要在 Deployment 中描述你想要的目标状态是什么，Deployment controller 就会帮你将 Pod 和 Replica Set 的实际状态改变到你的目标状态，常用于扩容缩容。</p>
<p>（6）创建pod的流程？</p>
<ol>
<li>Kubernetes API Server 创建 Pod Spec，并将其存储在 etcd 中。</li>
<li>Kubernetes Controller Manager 根据 Pod Spec 创建 Pod，并将其存储在 etcd 中。</li>
<li>Kubernetes API Server 为 Pod 分配 IP 地址，并将其存储在 etcd 中。</li>
<li>Kubernetes Scheduler 根据 Pod 的资源需求和节点资源状况，将 Pod 调度到一个合适的节点上，并将调度信息存储在 etcd 中。</li>
<li>Kubernetes Kubelet 在节点上根据container runner创建容器，并将容器状态更新到 Kubernetes API Server 中。</li>
<li>Kubernetes Kubelet 定期检查容器状态，并根据需要重启容器。</li>
</ol>
<h2 id="分布式"><a href="#分布式" class="headerlink" title="分布式"></a>分布式</h2><h3 id="高可靠"><a href="#高可靠" class="headerlink" title="高可靠"></a>高可靠</h3><p>（1）如何容灾？<br>容灾是为了在遭遇灾害时能保证信息系统能正常运行，遵循两地三中心原则<br>    两地是指<strong>同城、异地</strong><br>    三中心是指<strong>生产中心、同城容灾中心、异地容灾中心</strong>。<br>    同城：在同城或相近区域内 （ ≤ <strong>200KM</strong> ）建立两个数据中心 : 日常情况下可同时分担业务及管理系统的运行，并可切换运行。<br>    异地：在距离较远的地方采用异步镜像的方式保存数据，防范战争、地震、水灾等风险<br>    三中心是指，生产中心负责日常的请求处理，数据远程复制到同城容灾中心，同成容灾中心的数据异步远程复制到异地容灾中心</p>
<h2 id="实践经历"><a href="#实践经历" class="headerlink" title="实践经历"></a>实践经历</h2><h3 id="项目"><a href="#项目" class="headerlink" title="项目"></a>项目</h3><p>（1）系统监控Alarm是如何实现的？<br>每个进程使用CPU以CPU时间片为单位，如果想要对进程的一部分代码段进行监控，可以用两个系统调用来实现，它涉及到的主要是中断相关的知识。<br>一个系统调用是<strong>sigalarm</strong>用来完成具体的逻辑，第一个参数用来设置时钟中断的次数，第二个参数是到达次数后回调的处理函数。它的具体逻辑是给进程控制块添加三个新的变量和一个新结构体并初始化，分别表示进程已经中断的次数，中断次数的阈值，处理函数的地址。随后在时钟中断的处理函数中添加判断语句，如果进程注册了系统监控，则将计数器加一。当计数器达到阈值，保存当前寄存器的上下文，设置PC寄存器的值为中断处理函数的入口，执行报警操作<br>第二个系统调用用来返回原本的进程，在处理函数的最后调用。它的作用是将切换PC前保存的上下文再切换回去</p>
<p>（2）写时复制是如何实现的？<br>在原本的xv6中，每一次fork都会给子进程分配物理内存。而大多数情况下fork仅仅是sh窗口用来启动进程的方式，分配的页表会被exec替换掉。引入写时复制可以避免无意义的内存分配，加快进程创建速度，它主要涉及到的是内存管理相关的知识。<br>fork系统调用为子进程分配物理页是在uvmcopy函数中完成，该函数会遍历父进程的页表，找到对应的物理页，再给子进程分配新物理页，将数据拷贝过去，随后分配虚拟页并建立虚拟页和物理页的映射关系保存在子进程的页表中。<br>我的修改方式是不再给子进程分配物理页，仅分配虚拟页，然后建立子进程虚拟页到父进程物理页的映射关系，并将这中间过程的PTE设置为只读不可写。这样一旦发生写操作就会触发缺页中断。这种思想其实在到处都有体现，比如redis在主从同步时会fork出子进程来进行数据copy。<br>当发生缺页中断时，stval寄存器会记录发生错误的地址。此时调用kalloc给子进程分配物理页，并重新建立发生错误的页和新分配物理页的映射关系。<br>由于这个过程涉及到多个进程映射同一个物理页，因此为了防止某个进程错误的释放了物理页。还需要新增一个全局数组记录整个物理空间每个物理页的引用计数。归还物理空间时如果引用技术不为1，则仅仅减少引用计数即可。该数组在操作时需要上锁。</p>
<p>在写代码过程中最大的困难是，在分配内存时有一段逻辑是如果当前页面的引用数不为0则报错，否则置为1然后分配出去。由于这个读取在逻辑上是一个前后串行的关系，就觉得不需要再上锁了，结果由于编译器优化，导致内存分配失败。实际的执行顺序与逻辑执行顺序不一致，引用计数赋值为1在前，不为0则报错在后。进一步让我意识到了并发问题的两个核心原因：编译器优化导致的乱序执行以及MSEI协议的优化导致CPU缓存不一致。</p>
<p>（3）如何实现内存分配的锁分段优化？<br>xv6最初的内存分配是由一个全局空闲链表维护的，多个CPU并发分配内存需要涉及到锁争夺，因此可以基于锁分段的思想，将大的空闲链表拆分为每个CPU自己维护的小空闲链表，这几个链表放在一个结构体数组中维护，数组下标就是CPUid。之后只需要修改kinit，kalloc，kfree三个函数即可。kinit会在操作系统启动时将内存初始化并切割成页串成空闲链表。kalloc会获取CPUid，然后找到自己的小链表，上锁并分配内存，如果链表为空，则释放锁，然后去其他空闲链表中上锁并偷取一个。kfree则在释放时CPU将内存页放在自己的空闲链表中即可</p>
<p>这个内容其实难点在于实现内存页的偷取，这个过程和GMP有点相似，因此其实我的这种方法还是存在优化空间的。例如可以引入全局队列，通过机制保证各个空闲链表之间的大小均衡。</p>
<p>（4）如何实现软连接功能？<br>软链接可以简单理解为快捷方式，它的作用是间接指向一个文件或目录。实现软链接主要涉及到的是文件系统相关的知识。<br>文件系统总共分为七层。驱动层、buffer cache层，log层、inode层、目录层、路径层和文件层。由于linux万物皆文件的特性，其实所有文件背后都是inode结构体，该结构体包含了一个变量来表示该inode的类型，例如是目录、普通文件还是设备。<br>实现软链接其实就是新增一种新的inode类型，并在create和open中添加配套的if处理语句。sys_symlink需要接收两个参数，已经存在的文件名和新创建的软链接文件名。利用路径层提供的接口，将文件名转化为文件路径。随后调用文件层的create函数传入文件路径和软链接标志作为参数创建一个新的inode节点。该inode和其他普通inode拥有相同的结构体，只不过类型为软链接类型，addr中保存的是链接文件inode的路径。在open时如果发现文件对应的inode是软链接类型，则递归查找</p>
<p>难点在于理清楚不同文件系统层之间的关系</p>
<p>（5）如何实现mmap？<br>正常情况下写文件，需要复制到进程的空间中再进行修改，完成后再copy回去。这个过程涉及到两次数据copy，效率低。mmap是一种优化手段，通过建立虚拟地址与文件描述符的映射关系，避免数据copy。<br>mmap是一个系统调用，参数包括了映射的虚拟地址和长度，文件号和偏移量、映射权限。新建一个数据结构vma是用来保存这些参数。通过在进程控制块中添加一个vma数组，表示一系列的映射，添加一个maxaddr表示映射的起始地址（linux的内存顺序是堆、内存映射、栈，但是在xv6中，位置是内存映射、堆、栈）。在当调用mmap时，从获取当前的进程的结构体，在vma数组中找到一个空闲vma，寄存器获取参数并进行检查后对该vma赋值，并增加一次文件的引用数。这样映射关系就建立好了。<br>当访问建立映射的虚拟地址时，会触发13或15号缺页中断，此时通过stval寄存器取出报错的虚拟地址，遍历进程的vma数组，找到对应的vma，获取文件描述符，分配物理内存页，利用文件系统提供的readi接口将文件内容读取到该物理地址，并调用内存管理系统提供的接口建立虚拟地址和物理地址的映射关系。<br>最后再进行善后工作，例如在fork中添加额外的vma拷贝的代码段。</p>
<p>难点：难点在于理解文件系统和虚拟映射。mmap本身是很多后端技术的技术，linux的mmap涉及到了很多的优化方案，我这里的实现比较简陋。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%90%8E%E7%AB%AF/" class="category-chain-item">后端</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E9%9D%A2%E7%BB%8F/" class="print-no-link">#面经</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>面试知识点整理</div>
      <div>http://example.com/2024/05/17/面试知识点整理/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Cygnus</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年5月17日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/05/26/Redis%E8%B0%83%E4%BC%98%E7%AD%96%E7%95%A5/" title="Redis调优策略">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Redis调优策略</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/05/07/Golang-Context/" title="Golang Context">
                        <span class="hidden-mobile">Golang Context</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
